(self.webpackChunk=self.webpackChunk||[]).push([[312],{6312:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>n});a(1263),a(122);var o=a(629);function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const s={name:"GroupProductsList",components:{"tree-item":{template:'<li>\n                <div\n                  v-if="!isBase"\n                  :class="{bold: isFolder}"\n                  @click="toggle"\n                  @dblclick="makeFolder">\n                  {{ item.name }}\n                  <span v-if="isFolder">[{{ isOpen ? "-" : "+" }}]</span>\n                  \n                </div>\n                <a\n                    v-if="!isBase"\n                    @click="$emit(\'edit-item\', item)" \n                    href="#"\n                    >\n                    Ред.\n                </a>\n                <a\n                    v-if="!isBase"\n                    @click="$emit(\'remove-item\', item)" \n                    href="#"\n                    >\n                    Удалить\n                </a>\n                \n                <ul v-show="isOpen" v-if="isFolder">\n                  <tree-item\n                    class="item"\n                    v-for="(child, index) in item.children"\n                    :key="index"\n                    :item="child"\n                    @make-folder="$emit(\'make-folder\', $event)"\n                    @add-item="$emit(\'add-item\', $event)"\n                    @edit-item="$emit(\'edit-item\', $event)"\n                    @remove-item="$emit(\'remove-item\', $event)"\n                  ></tree-item>\n                  <li class="add" @click="$emit(\'add-item\', item)">+</li>\n                </ul>\n            </li>',props:{item:Object},name:"tree-item",data:function(){return{isOpen:!0}},computed:{isFolder:function(){return this.item.children,this.item.children&&Object.keys(this.item.children).length},isBase:function(){return this.item.children&&this.item.is_base}},methods:{toggle:function(){this.isFolder&&(this.isOpen=!this.isOpen)},makeFolder:function(){this.isFolder||(this.$emit("make-folder",this.item),this.isOpen=!0)},editItem:function(){console.log("name"),this.$emit("edit-item",this.item)}}}},data:function(){return{IsEmptyTree:!0,group_products:{},pagination:{},remove_group_product_name:"",remove_group_product_id:0,param_group_product_id:null,isViewCreate:!0,formData:{},formCreateData:{name:"",description:"",group_product_id:null,store_id:0,id:0},create_errors:{},errors:{},treeData:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},(0,o.rn)({cur_store_name:function(t){return t.select_store_name},cur_store_id:function(t){return t.select_store_id}})),methods:{makeFolder:function(t){this.addItem(t)},addItem:function(t){console.log(t.name),this.formCreateData.group_product_id=t.id,this.showAddModal()},addItemForEmpty:function(){this.formCreateData.group_product_id=null,this.showAddModal()},removeItem:function(t){this.showRemoveModal(t.id,t.name)},editItem:function(t){this.param_group_product_id=t.id,console.log("id:"+this.param_group_product_id),this.showEditModal()},showEditModal:function(){this.isViewCreate=!1,this.getDetailGroupProduct(),$(this.$refs.modal3).modal("show")},saveEditModal:function(){$(this.$refs.modal3).modal("hide"),this.sendData(),console.log("pre getGroupProductsThree")},showAddModal:function(){this.isViewCreate=!0,$(this.$refs.modal3).modal("show")},saveAddModal:function(){$(this.$refs.modal3).modal("hide"),this.sendData(),this.getGroupProductsThree()},getGroupProductsThree:function(){var t=this,e=localStorage.getItem("token");axios.defaults.headers.common.Authorization="Bearer "+e,axios.post("/api/get_group_product_three_list",{store_id:this.cur_store_id}).then((function(e){Object.keys(e.data.group_products).length>0?t.IsEmptyTree=!1:t.IsEmptyTree=!0;var a={id:null,name:"root",is_base:1,children:e.data.group_products};t.treeData=a})).catch((function(t){console.log(t)}))},getGroupProducts:function(t){var e=this,a=localStorage.getItem("token");axios.defaults.headers.common.Authorization="Bearer "+a,t=t||"api/get_group_product_list",axios.post(t,{store_id:this.cur_store_id}).then((function(t){console.log("group_products length:"+t.data.group_products.data.length),e.group_products=t.data.group_products.data,e.makePagination(t.data.group_products)})).catch((function(t){console.log(t)}))},makePagination:function(t){var e={current_page:t.current_page,last_page:t.last_page,prev_page_url:t.prev_page_url,next_page_url:t.next_page_url};this.pagination=e},showRemoveModal:function(t,e){this.remove_group_product_name=e,this.remove_group_product_id=t,$(this.$refs.modal2).modal("show")},removeGroupProduct:function(){var t=this,e=localStorage.getItem("token");axios.defaults.headers.common.Authorization="Bearer "+e;var a={id:this.remove_group_product_id};axios.post("/api/remove_group_product",a).then((function(e){$(t.$refs.modal2).modal("hide"),t.getGroupProductsThree()})).catch((function(e){t.create_errors=e.response.data.errors}))},sendData:function(){this.isViewCreate?(console.log("sendCreateGroupProduct"),this.sendCreateGroupProduct()):(console.log("sendUpdateGroupProduct"),this.sendEditGroupProduct())},sendCreateGroupProduct:function(){var t=this,e=localStorage.getItem("token");this.formCreateData.store_id=this.cur_store_id,axios.defaults.headers.common.Authorization="Bearer "+e,axios.post("/api/create_group_product",this.formCreateData).then((function(e){$(t.$refs.modal3).modal("hide"),t.resetFormCreate(),t.getGroupProductsThree()})).catch((function(e){t.create_errors=e.response.data.errors}))},sendEditGroupProduct:function(){var t=this,e=localStorage.getItem("token");axios.defaults.headers.common.Authorization="Bearer "+e,this.formCreateData.id=this.param_group_product_id,axios.post("/api/update_group_product",this.formCreateData).then((function(e){$(t.$refs.modal3).modal("hide"),t.resetFormCreate(),t.getGroupProductsThree()})).catch((function(e){t.create_errors=e.response.data.errors}))},resetFormCreate:function(){this.formCreateData.group_product_id=null,this.formCreateData.id=0,this.formCreateData.store_id=0,this.formCreateData.name="",this.formCreateData.description=""},getDetailGroupProduct:function(){var t=this,e=localStorage.getItem("token");axios.defaults.headers.common.Authorization="Bearer "+e,axios.post("/api/detail_group_product_info",{id:this.param_group_product_id,store_id:this.cur_store_id}).then((function(e){t.formCreateData.name=e.data.group_product.name,t.formCreateData.description=e.data.group_product.description,t.formCreateData.group_product_id=e.data.group_product.group_product_id})).catch((function(e){t.create_errors=e.response.data.errors}))}},mounted:function(){this.getGroupProductsThree()}};const n=(0,a(1900).Z)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("h2",[t._v("Группа запчастей")]),t._v(" "),a("div",{ref:"modal2",staticClass:"modal fade",attrs:{id:"exampleModal2",tabindex:"-1","aria-labelledby":"exampleModalLabel2","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),a("div",{staticClass:"modal-body"},[t._v("\n                    Вы уверены, что хотите удалить группу запчастей:"+t._s(t.remove_group_product_name)+"?\n                ")]),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.removeGroupProduct}},[t._v("Удаление")])])])])]),t._v(" "),a("div",{ref:"modal3",staticClass:"modal fade",attrs:{id:"exampleModal3",tabindex:"-1","aria-labelledby":"exampleModalLabel3","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[t.isViewCreate?a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel3"}},[t._v("Добавление группы запчастей")]):t._e(),t._v(" "),t.isViewCreate?t._e():a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel3"}},[t._v('Редактируем группу запчастей: "'+t._s(t.formCreateData.name)+'" ')])]),t._v(" "),t._m(1)])]),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"name"}},[t._v("Название")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formCreateData.name,expression:"formCreateData.name"}],staticClass:"form-control",attrs:{type:"text",name:"name"},domProps:{value:t.formCreateData.name},on:{input:function(e){e.target.composing||t.$set(t.formCreateData,"name",e.target.value)}}}),t._v(" "),a("p",{staticClass:"text-danger",domProps:{textContent:t._s(t.create_errors.name)}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"description"}},[t._v("Описание")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formCreateData.description,expression:"formCreateData.description"}],staticClass:"form-control",attrs:{type:"text",name:"description"},domProps:{value:t.formCreateData.description},on:{input:function(e){e.target.composing||t.$set(t.formCreateData,"description",e.target.value)}}}),t._v(" "),a("p",{staticClass:"text-danger",domProps:{textContent:t._s(t.create_errors.description)}})])]),t._v(" "),a("div",{staticClass:"modal-footer"},[t.isViewCreate?a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.sendData}},[t._v("Добавить")]):t._e(),t._v(" "),t.isViewCreate?t._e():a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.sendData}},[t._v("Редактировать")])])])])]),t._v(" "),a("ul",{attrs:{id:"demo"}},[a("tree-item",{staticClass:"item",attrs:{item:t.treeData},on:{"make-folder":t.makeFolder,"add-item":t.addItem,"edit-item":t.editItem,"remove-item":t.removeItem}})],1),t._v(" "),t.IsEmptyTree?a("div",[a("button",{on:{click:t.addItemForEmpty}},[t._v("Создать")])]):t._e()])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel2"}},[t._v("Удаление группы запчастей")])]),t._v(" "),a("div",{staticClass:"col-6"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-6"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],!1,null,null,null).exports}}]);